from diffco.utils import load_dataset
import torch
import argparse

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Convert a csv dataset file generated by C++ code to the .pt format used in python scripts.')
    parser.add_argument('path', type=str, help='Path to the csv dataset file')
    parser.add_argument('robot_name', type=str, help='Robot name (Baxter, panda, 2d)')
    parser.add_argument('group', type=str, help='Move group name')
    parser.add_argument('--output', '-o', type=str, default='', help='Path to the output file')
    args = parser.parse_args()
    print(args)

    if args.output == '':
        args.output = args.path.replace('.csv', '.pt')
    dataset = load_dataset(args.path, args.robot_name, args.group)
    torch.save(dataset, args.output)
    print(f'======== Output file saved to {args.output} ========')